<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- Generated by IDLdoc 3.6.1 on Tue May 16 12:42:24 2017 -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>pp_drawsphericalpoly.pro (Documentation for pp_lib)</title>

    

    <script type="text/javascript" src="idldoc-resources/js/jquery.js"></script>
    <script type="text/javascript" src="idldoc-resources/js/copybutton.js"></script>

    
    <style type="text/css" media="all">
            /* setup page */
      body { font-family: Helvetica, sans-serif; font-size: 12pt; margin: 0; padding: 0; }
      div.content { padding: 1em; }
      p { line-height: 1.4; }
      td p { padding-bottom: 0.5em; }
      img { border: 0; }
      
      /* link styles */
      a { text-decoration: none; }
      a:link, a:visited { color: #0000FF; }
      a:hover, a:focus { background: yellow; border-bottom: 1emx dotted #303099; }
      
      /* dir-overview styles */
      dt.filename { margin-top: 0.5em; }
      dl.file_listing { margin-left: 1em; }
      
      /* titles */
      h1, h2, h3, h4 { font-weight:normal; color: #871E31; margin-top: 1.5em; }
      h4 { margin-bottom: 0.25em; }
      .center { margin-left: auto; margin-right: auto; }
      .small { font-family: Verdana, Helvetica, sans-serif; font-size: 90%; }
      .smaller { font-family: Verdana, Helvetica, sans-serif; font-size: 80%; }
      .smallest { font-family: Verdana, Helvetica, sans-serif; font-size: 70%; }
      h1.basename { margin-top: 0; margin-bottom: 0; }
      h1.basename span.file-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      h2.directory { font-size: 90%; margin-bottom: 0; }
      h2.routine-name { margin-top: 0; margin-bottom: 0; }
      p.categories { color: #384806; margin-top: 0; }
      span.file_attribute { float: right; color: #384806; margin: 0 0 1em 3em; }
      div#file_comments { margin-top: 1em; }
      
      div.routine-details { border: 1px dotted #C0C0C0; margin-top: 1em; padding: 1em; }
      span.routine-attributes { font-size: 70%; margin-left: 3em; color: #384806; }
      div.details dt { color: #871E31; margin-left: 2em; }
      div.details dt span { color: #384806; margin-left: 2em; }
      div.details dd { margin: 0.5em 2em 1em 4em; }
      a.top {
        font-family: Verdana, Helvetica, sans-serif;
        font-size: 8pt;
        font-weight: bold;
        color: #5070ff;
        text-transform: uppercase;
        float: right;
        margin-left: 1em;
      }
      
      /* comments */
      .pre { white-space: pre; }
      
      /* code styles */
      code { font-family: Monaco, "Courier New", Courier, monospace; font-size: 95%; }
      code.listing { white-space: pre; display: block; margin: 0.75em 0 0.75em 0; padding: 0 3em 0 1em; line-height: 1.4em; }
      code.source { white-space: pre; display: block; }
      code.source span.comments { color: #408080; }
      .syntax { margin-top: 1em; margin-left: 1.5em; text-indent: -1.5em; }
      .var { font-style: italic; }
      .argument { } /* white-space: nowrap; does not work in Safari (and sometimes not even in Firefox) */
      
      dl.routine-summary dt { margin-bottom: 0.25em; }
      dl.routine-summary dd { margin-bottom: 0.5em; margin-left: 2em; }
      
      ul.inherited-method-summary { padding-left: 0em; margin-left: 0em; }
      
      /* general styles */
      ul li { list-style-type: none; }
      table { empty-cells: show; }
      thead { color: #871E31; }
      dd { margin-bottom: 0.35em; }
      input, textarea { background: #F3F6ED; border: #E1D6C6 1px solid; padding: 2px 1em 2px 0.5em; }
      input.text { background: #FFFFC0; }
      
      div.note { margin: 1em 2em 1em 2em; background: #EFEFEF; border: 1px #A0A0A0 dotted; padding: 0 1em 0 1em; }
      p.indent { margin-left: 2em; }
      
      /* An attribute table is a vertical list of name-value pairs. */
      table.box {
        background: #EFEFEF;
        border: 1px #A0A0A0 dotted;
        padding-top: 0.75em;
        padding-bottom: 0.75em;
      }
      table.attribute { padding-left: 0.75em; padding-right: 0.75em; }
      table td { vertical-align: top; }
      table.attribute p { margin: 0; }
      table td.name { font-style: normal; padding-right: 1.5em; }
      ul.fieldslist { padding-top: 0; color: #909090; }
      ul.fieldslist li { margin-bottom: 0.25em; }
      span.fieldname { color: #000000; }
      
      dl.attribute dt { color: #990000; }
      
      /* header/navbar styles */
      div.header { padding: 2em 2em 0 2em; background: #9E9D7B; border-bottom: 2px #262626 solid; }
      div.header h1 { color: white; margin:0; font-weight: normal; }
      div.header h2 { color: white; margin-top: 0; margin-bottom: 1em; font-weight: normal; font-style: italic; font-size: 100%; }
      table.navbar { background: #CCC097; margin: 0; padding: 0; border-bottom: 1px #262626 dotted; width: 100%; }
      table.navbar td { padding: 4px 0.5em 3px 0.5em; white-space: nowrap; vertical-align: top; }
      table.navbar td.flexible { width: 100%; text-align: right; padding-right: 1em; white-space: nowrap; }
      table.navbar td.selected { background: #262626; }
      table.navbar td.selected, table.navbar td.selected a { color: white; }
      table.navbar a:hover, table.navbar a:focus { background: inherit; border-bottom: 1px solid #303099; }
      p.localnavbar { text-align: right; margin: 0.2em 1em 0.2em 0.2em; padding: 0; }
      
      /* CSS graphics styles */
      div.box {
        margin-left: 0.25em;
        display: inline-block;
        width: 0.9em;
        height: 0.9em;
        vertical-align: -1px;
      }
      .red { background-color: #A00; }
      .orange { background-color: #F40; }
      .green { background-color: #480; }
      
      /* index styles */
      span.index_type { margin-left: 1em; }
      dl.index_listing dd { margin-bottom: 0.5em; margin-left: 2em; }
      dl.index_listing dd p { margin-top: 0.2em; margin-bottom: 0em; }
      
      /* search styles */
      fieldset { border: #ddd 1px solid; padding: 1em; margin-top: 3em; }
      legend { color: #871E31; font-size: 120%; }
      label { white-space: nowrap; }
      p.description { margin: 2em 2em 1em 2em; }
      form table td.name { vertical-align: middle; }
      
      /* footer styles */
      div.footer { padding: 0.5em 1em 0.5em 1em; background: #EFEFEF; border-top: 1px #A0A0A0 dotted; }
      div.footer table { width: 100%; }
      div.footer td.right { text-align: right; }

    </style>
    <style type="text/css" media="print">
            p.localnavbar { display: none; }
      
      div.header { background: white; }
      div.header h1 { color: black; }
      div.header h2 { color: black; }

    </style>
    

    <script type="text/javascript">
      function setTitle() {
        parent.document.title="pp_drawsphericalpoly.pro (Documentation for pp_lib)";
      }
    </script>
  </head>

  <body onload="setTitle();" id="root">

    <div class="header">
      <h1>Documentation for pp_lib</h1>
      <h2>Generated by IDLdoc</h2>
    </div>
    
    
    <table class="navbar smaller" summary="Navigation header" cellspacing="0">
      <tr>
        <td >
          <a href="overview.html">Overview</a>
        </td>
    
        <td >
          Directory
        </td>
    
        <td class="selected">File</td>
    
        
        <td >
          <a href="pp_drawsphericalpoly-code.html" title="Chromocoded source">Source</a> <a href="pp_drawsphericalpoly.pro" title=".pro file"><img src="idldoc-resources/attach.png" alt="[attach.png]" align="top"/></a>
        </td>
        
    
        <td >Etc</td>
    
        <td >
          <a href="categories.html">Categories</a>
        </td>
    
        <td >
          <a href="search.html">Search</a>
        </td>
    
        
        <td >
          <a href="idldoc-index.html">Index</a>
        </td>
        
    
        
        <td >
          <a href="idldoc-warnings.html">Warnings</a>
        </td>
        
    
        <td >
          <a href="idldoc-help.html">Help</a>
        </td>
    
        <td class="flexible">
          Developer documentation
        </td>
      </tr>
    </table>
    
    
    
    <p class="localnavbar smallest"><a href="" target="_top">single page</a> | <a href="index.html" target="_top">use frames</a> &nbsp;&nbsp;&nbsp; summary &nbsp;&nbsp;&nbsp; class &nbsp;&nbsp;&nbsp; fields &nbsp;&nbsp;&nbsp; <a href="#routine-details">routine details</a> &nbsp;&nbsp;&nbsp; <a href="#attributes">file attributes</a></p>
    
    
    
    
    
    
    
    
    

    <div class="content">
      <h2 class="directory">./</h2>
      <h1 class="basename">pp_drawsphericalpoly.pro<span class="file-attributes"></span></h1>
      

      
      
      
      <br/>

      

      

      
      <h2>Author information</h2>

        <dl class="attribute small" summary="File author information">
          
            <dt>Author</dt>
            <dd><p>Paulo Penteado (http://www.ppenteado.net), Aug/2015
</p>

</dd>
          

          

          

          
        </dl>
      

      

      

      
      <div>
        <h2>Routines</h2>
        

      

      

      
      </div>
      

      
      <div id="routine-details">
        

        
        <div class="routine-details details" id="pp_drawsphericalpoly">
          <h2 class="routine-name"><a href="#root" class="top">top</a> <a href="pp_drawsphericalpoly-code.html#pp_drawsphericalpoly:source" class="top">source</a> pp_drawsphericalpoly<span class="routine-attributes"></span></h2>

          

          <p class="syntax"><code>pp_drawsphericalpoly<span class="argument">, <a href="#pp_drawsphericalpoly:p:ilons">ilons</a></span><span class="argument">, <a href="#pp_drawsphericalpoly:p:ilats">ilats</a></span><span class="argument">, <a href="#pp_drawsphericalpoly:p:icolors">icolors</a></span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:_ref_extra">_ref_extra</a>=<span class="var">_ref_extra</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:rgb_table">rgb_table</a>=<span class="var">rgb_table</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:cg">cg</a>=<span class="var">cg</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:graphics">graphics</a>=<span class="var">graphics</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:itool">itool</a>=<span class="var">itool</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:direct">direct</a>=<span class="var">direct</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:maxlength">maxlength</a>=<span class="var">maxlength</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:nsegments">nsegments</a>=<span class="var">nsegments</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:polygon">polygon</a>=<span class="var">polygon</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:x">x</a>=<span class="var">x</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:y">y</a>=<span class="var">y</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:connectivity">connectivity</a>=<span class="var">connectivity</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:fill">fill</a>=<span class="var">fill</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:stackmap">stackmap</a>=<span class="var">stackmap</span>]</span><span class="argument">, <a href="#pp_drawsphericalpoly:k:original_image">original_image</a>=<span class="var">original_image</span></span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:maxstack">maxstack</a>=<span class="var">maxstack</span>]</span><span class="argument">, <a href="#pp_drawsphericalpoly:k:stacklist">stacklist</a>=<span class="var">stacklist</span></span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:stackcount">stackcount</a>=<span class="var">stackcount</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:verbose">verbose</a>=<span class="var">verbose</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:do_stack">do_stack</a>=<span class="var">do_stack</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:weights">weights</a>=<span class="var">weights</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:stackweights">stackweights</a>=<span class="var">stackweights</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:stackindex">stackindex</a>=<span class="var">stackindex</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:pcount">pcount</a>=<span class="var">pcount</span>]</span><span class="argument">, <a href="#pp_drawsphericalpoly:k:no_fix_lon">no_fix_lon</a>=<span class="var">no_fix_lon</span></span><span class="argument">, <a href="#pp_drawsphericalpoly:k:map_structure">map_structure</a>=<span class="var">map_structure</span></span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:image_mapstr">image_mapstr</a>=<span class="var">image_mapstr</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:xsize">xsize</a>=<span class="var">xsize</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:ysize">ysize</a>=<span class="var">ysize</span>]</span><span class="argument"> [, <a href="#pp_drawsphericalpoly:k:e_map">e_map</a>=<span class="var">e_map</span>]</span><span class="argument">, <a href="#pp_drawsphericalpoly:k:bmin">bmin</a>=<span class="var">bmin</span></span><span class="argument">, <a href="#pp_drawsphericalpoly:k:bmax">bmax</a>=<span class="var">bmax</span></span><span class="argument">, <a href="#pp_drawsphericalpoly:k:bnan">bnan</a>=<span class="var">bnan</span></span><span class="argument">, <a href="#pp_drawsphericalpoly:k:btop">btop</a>=<span class="var">btop</span></span></code></p>

          
          <div ><p>    Draws polygons on a map, with the polygon sides resampled to a large number
    of vertices, so that the result resembles a spherical polygon (a polygon where
    the sides are great circle arcs). Polygons can be drawn on Coyote Graphics,
    iTools, Function Graphics or Direct Graphics. Se examples below.
    Makes use of <a href="./pp_sphericalpath.html#pp_sphericalpath"><code>pp_sphericalpath</code></a> to calculate the polygonal approximation to
    the spherical polygon.
</p>

<p></p>

</div>
          

          

          
          <h3>Parameters</h3>
            <dl>
              
              <dt id="pp_drawsphericalpoly:p:ilons">ilons <span class="smaller">in required </span></dt>
              <dd class="small"><p>      An array of longitudes for the vertices which are to be connected by a path made of great circles.
      Must be in degrees. Multiple polygons are supported in two different ways: 1) If all N polygons have
      the same number of vertices (M), lons can be given as a [M,N] array. 2) For arbitrary numbers of vertices,
      lons is given as a list, where each list element is an array of vertices for one polygon.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:p:ilats">ilats <span class="smaller">in required </span></dt>
              <dd class="small"><p>      An array of latitudes for the vertices which are to be connected by a path made of great circles.
      Must be in degrees. Multiple polygons are supported in two different ways: 1) If all N polygons have
      the same number of vertices (M), lats can be given as a [M,N] array. 2) For arbitrary numbers of vertices,
      lons is given as a list, where each list element is an array of vertices for one polygon.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:p:icolors">icolors <span class="smaller">in required </span></dt>
              <dd class="small"><p>      An array with the color to be used to draw/fill the polygons. If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:rgb_table"><code>rgb_table</code></a>
      is not given, this array is assumed to contain the colors in the system used
      by the kind of plotting selected: either a [3,M] array of color triplets, one triple
      per each of the M polygons, or a long integer array, with one long-integer-coded
      color for each of the M polygons.
      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:rgb_table"><code>rgb_table</code></a> is given, then colors can be an array of any numerical type, and
      the polygon colors will be determined by mapping the values in <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly_cg:p:colors"><code>colors</code></a> to
      values in the 256-value colortable specified by <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:rgb_table"><code>rgb_table</code></a>.
</p>

<p></p>

</dd>
              
            </dl>
          

          
          <h3>Keywords</h3>
            <dl>
              
              <dt id="pp_drawsphericalpoly:k:_ref_extra">_ref_extra <span class="smaller">in out optional </span></dt>
              <dd class="small"><p>      Any extra arguments are passed to the polygon plotting routine: cgpolygon if
      <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:cg"><code>cg</code></a> is selected, ipolygon if <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:itool"><code>itool</code></a> is selected, polygon() if <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:graphics"><code>graphics</code></a> is
      selected, or polyfill, if <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:direct"><code>direct</code></a> is selected.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:rgb_table">rgb_table <span class="smaller">in optional </span></dt>
              <dd class="small"><p>      The color table to be used to map intensities into colors. This can be either
      a scalar, which will be used to select one of IDL's predefined colortables
      (0 is grayscale), or a [3,256] array of color triples, or a 256-element array
      of long integers.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:cg">cg <span class="smaller">in optional default=0</span></dt>
              <dd class="small"><p>      If set, plotting is made with Coyote Graphics' cgpolygon.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:graphics">graphics <span class="smaller">in optional default=1</span></dt>
              <dd class="small"><p>      If set, plotting is made with IDL's Function Graphics' polygon().
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:itool">itool <span class="smaller">in optional default=0</span></dt>
              <dd class="small"><p>      If set, plotting is made with IDL's iTools' ipolygon.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:direct">direct <span class="smaller">in optional default=0</span></dt>
              <dd class="small"><p>      If set, plotting is made with IDL's Direct Graphics' polyfill.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:maxlength">maxlength <span class="smaller">in optional </span></dt>
              <dd class="small"><p>      Passed on to <a href="./pp_sphericalpath.html#pp_sphericalpath"><code>pp_sphericalpath</code></a>, determines the maximum length of the polygon
      sides used for plotting, in degrees.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:nsegments">nsegments <span class="smaller">in optional </span></dt>
              <dd class="small"><p>      Passed on to <a href="./pp_sphericalpath.html#pp_sphericalpath"><code>pp_sphericalpath</code></a>, determines the number of segments to use for
      the polygon sides.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:polygon">polygon <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If Function Graphics or iTools are being used for plotting, returns the polygon
      object created with them.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:x">x <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If Function Graphics or iTools are being used for plotting, arrays of x and y points
      get created, one for each vertex of all polygons plotted. This keyword returns
      the x coordinates of the vertices created.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:y">y <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If Function Graphics or iTools are being used for plotting, arrays of x and y points
      get created, one for each vertex of all polygons plotted. This keyword returns
      the y coordinates of the vertices created.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:connectivity">connectivity <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If Function Graphics or iTools are being used for plotting, arrays of x and y points
      get created, one for each vertex of all polygons plotted. This keyword returns
      the connectivity array which specifies which vertices belong to each polygon. See IDL's help
      on polygon() for more details.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:fill">fill <span class="smaller">in optional default=0.</span></dt>
              <dd class="small"><p>      If Coyote Graphics' cgpolygon is being used, this keyword determines if
      the polygons are drawn just as outlines, or should be filled (outlines and
      fills share the same colors).
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:stackmap">stackmap <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      if <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is turned on, this argument returns the stacked map generated. If the algorithm
      selected is <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a>=1, this will be an array of dimensions [<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:maxstack"><code>maxstack</code></a>,<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:xsize"><code>xsize</code></a>,<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:ysize"><code>ysize</code></a>], where
      [<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:xsize"><code>xsize</code></a>,<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:ysize"><code>ysize</code></a>] are the dimensions of the map created, and <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:maxstack"><code>maxstack</code></a> specifies the maximum number
      layers the map stack can have. At a given location [x,y] in the map, the values stackmap[*,x,y]
      are all the values present in <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:p:icolors"><code>icolors</code></a> that fell onto that location on the map. The argument
      <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackcount"><code>stackcount</code></a> is often useful, as it records how many layers were stacked at each location in the
      map. This will probably be more clearly explained by the examples below.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:original_image">original_image <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:maxstack">maxstack <span class="smaller">in optional </span></dt>
              <dd class="small"><p>      Specifies the first dimension of the <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a> array, which is the maximum number of layers being
      tracked falling on each location on the map. If not set, it defaults to the number of polygons provided
      in <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:p:ilons"><code>ilons</code></a>, <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:p:ilats"><code>ilats</code></a>, <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:p:icolors"><code>icolors</code></a>. If there are many polygons, it is probably wise to specify a smaller
      value for maxstack, to avoid using too much memory. Use <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackcount"><code>stackcount</code></a> to check that at no location in the
      map there were polygons missed because that location had more overlapping layers than could fit into
      <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>: if <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackcount"><code>stackcount</code></a> is everywhere smaller than or equal to <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:maxstack"><code>maxstack</code></a>, no polygons were lost in
      <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:stacklist">stacklist <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:stackcount">stackcount <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      if <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is turned on, this argument returns the count of stacked layers in the <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>
      generated. At a given location [x,y] in the map, stackcount[x,y] is the number of polygons that
      fell on that map location (the number of layers in <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a> at that location). This will probably
      be more clearly explained by the examples below.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:verbose">verbose <span class="smaller">in optional </span></dt>
              <dd class="small"><p></p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:do_stack">do_stack <span class="smaller">in optional default=0</span></dt>
              <dd class="small"><p>      If set to 1, instead of drawing the polygons on the graphics device, a z-buffer will be used
      to draw polygons in an invisible direct graphics window, which are used to generate a map of
      where each polygon falls (<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>). This will probably be more clearly explained by the
      examples below. Note that setting do_stack to a value higher than 1 is not the same as setting
      it to 1: other values turn on alternative stack algorithms, which at this time are still
      experimental and thus not yet documented.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:weights">weights <span class="smaller">in optional </span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:stackweights">stackweights <span class="smaller">out optional </span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:stackindex">stackindex <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is turned on, this argument returns the an array similar to <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>, but its values
      are the indices to of the polygons that fall on each location, instead of being the intensities (<a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:p:icolors"><code>icolors</code></a>).
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:pcount">pcount <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is turned on, this argument returns the an array with the number of map pixels covered
      by each polygon.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:no_fix_lon">no_fix_lon <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:map_structure">map_structure <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:image_mapstr">image_mapstr <span class="smaller">out optional </span></dt>
              <dd class="small"><p>      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is set to 1, this argument will return the map structure created by map_set, which is
      used to define the map projection used to make <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:xsize">xsize <span class="smaller">in optional default=640</span></dt>
              <dd class="small"><p>      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is set to 1, this specifies the width of the map to generate (see <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>).
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:ysize">ysize <span class="smaller">in optional default=480</span></dt>
              <dd class="small"><p>      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is set to 1, this specifies the height of the map to generate (see <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>).
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:e_map">e_map <span class="smaller">in optional </span></dt>
              <dd class="small"><p>      If <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:do_stack"><code>do_stack</code></a> is set to 1, set this argument to a structure containing any parameters to be passed
      to map_set, which is used to define the map projection used to make <a href="./pp_drawsphericalpoly.html#pp_drawsphericalpoly:k:stackmap"><code>stackmap</code></a>. This will probably
      be more clearly explained by the examples below.
</p>

</dd>
              
              <dt id="pp_drawsphericalpoly:k:bmin">bmin <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:bmax">bmax <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:bnan">bnan <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
              <dt id="pp_drawsphericalpoly:k:btop">btop <span class="smaller"></span></dt>
              <dd class="small"></dd>
              
            </dl>
          

          
          <h3>Examples</h3>
          <div><p>      First, let's create some data to plot:
<div><div><code class="listing"><span class="code-output"> ;create several rectangles</span>
<span class="code-output"> lons=dblarr(4,10)</span>
<span class="code-output"> for i=0,9 do lons[*,i]=[-85d0,-65d0,-55d0,-75d0]+i*25d0</span>
<span class="code-output"> lats=dblarr(4,10)</span>
<span class="code-output"> for i=0,9 do lats[*,i]=[-65d0,55d0,45d0,-75d0]</span>
<span class="code-output"> ;set their colors</span>
<span class="code-output"> colors=dindgen(10)</span></code></div></div>      Now, plot the rectangles on a Graphics map:
<div><div><code class="listing"><span class="code-output"> m=map('mollweide')</span>
<span class="code-output"> pp_drawsphericalpoly,lons,lats,colors,rgb_table=13,linestyle='none'</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex1.png"/>
</p>

<p>      Plot the rectangles on an imap:
<div><div><code class="listing"><span class="code-output"> imap,map_projection='sinusoidal'</span>
<span class="code-output"> pp_drawsphericalpoly,lons,lats,colors,rgb_table=13,linestyle='none',/itool</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex2.png"/>
</p>

<p>      Plot the rectangles on a Coyote Graphics map:
<div><div><code class="listing"><span class="code-output"> m=cgmap('robinson',/erase,/isotropic,/window)</span>
<span class="code-output"> cgmap_grid,map=m,/box,/addcmd</span>
<span class="code-output"> cgloadct,13</span>
<span class="code-output"> pp_drawsphericalpoly,lons,lats,bytscl(colors),/cg,/fill,map=m,/addcmd</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex3.png"/>
</p>

<p>      Plot the rectangles on a Direct Graphics map:
<div><div><code class="listing"><span class="code-output"> map_set,0d0,0d0,/cylindrical,/isotropic,/grid,/label</span>
<span class="code-output"> pp_drawsphericalpoly,lons,lats,colors,rgb_table=13,/direct</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex4.png"/>
</p>

<p>      Now, let's make some data that spans the tricky region around the pole:
<div><div><code class="listing"><span class="code-output"> ;make up the coordinates for the coordinates of 3 rectangular fields of view near the north pole:</span>
<span class="code-output"> lons=[[20d0,240d0,260d0,0d0],[80d0,180d0,200d0,60d0],[50d0,210d0,230d0,30d0]]</span>
<span class="code-output"> lats=[[62d0,60d0,60d0,62d0],[62d0,60d0,60d0,62d0],[65d0,67d0,67d0,65d0]]</span>
<span class="code-output"> ;make up some pixel values to determine the color used to fill the 3 rectangles</span>
<span class="code-output"> pixvals=dindgen(3)</span>
</code></div></div>      Create an imap to plot these polygons:
<div><div><code class="listing"><span class="code-output"> imap,map_proj='orthographic',center_lat=60d0</span>
</code></div></div>      Draw the polygons:
<div><div><code class="listing"><span class="code-output"> pp_drawsphericalpoly,lons,lats,pixvals,rgb_table=13,/itool</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex5.png"/>
</p>

<p>      Now, an example with overlapping polygons, making an overlap map and taking the
      mean of the values on overlap:
<div><div><code class="listing"><span class="code-output"> lats=[[62d0,60d0,60d0,62d0],[62d0,60d0,60d0,62d0],[70d0,72d0,72d0,70d0],[80d0,87d0,87d0,80d0]]</span>
<span class="code-output"> lons=[[40d0,220d0,250d0,0d0],[80d0,180d0,200d0,60d0],[50d0,200d0,240d0,20d0],[70d0,70d0,95d0,95d0]]</span>
<span class="code-output"> pixvals=[0d0,-1d0,-3d0,2d0]</span>
</code></div></div>      First, take a look at the overlayed polygons:
<div><div><code class="listing"><span class="code-output"> m=map('orthographic',center_lat=30d0)</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex6.png"/>
</p>

<p>      Now, make the stack map:
<div><div><code class="listing"><span class="code-output"> pp_drawsphericalpoly,lons,lats,pixvals,rgb_table=13</span>
<span class="code-output"> limit=[-90,-180,90,180]</span>
<span class="code-output"> e_map={cylindrical:1,noborder:1,xmargin:0,ymargin:0,limit:limit,isotropic:1}</span>
<span class="code-output"> pp_drawsphericalpoly,lons,lats,pixvals,do_stack=1,stackc=stackc,e_map=e_map,xsize=3000,ysize=1500,maxstack=4,stackm=stackm</span>
</code></div></div>      Look at the coverage map - an array where each value is the number of polygons that fell onto that place on the map:
<div><div><code class="listing"><span class="code-output"> im0=image(stackc,map_projection='equirectangular',grid_units=2,image_location=limit[[1,0]],image_dimensions=[limit[3]-limit[1],limit[2]-limit[0]],dimensions=[900,500],color='cyan',aspect_ratio=5.,limit=[30,-180,90,180])</span>
<span class="code-output"> im1=image(stackc,map_projection='orthographic',center_lat=30,grid_units=2,image_location=limit[[1,0]],image_dimensions=[limit[3]-limit[1],limit[2]-limit[0]],,dimensions=[900,500],color='cyan',rgb_table=13)</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex7.png"/>
      <img src="pp_drawsphericalpoly_ex8.png"/>
</p>

<p>      Make an average image from stackm, by taking then mean over the stack (first) dimension:
<div><div><code class="listing"><span class="code-output"> stackmean=mean(stackm,dimension=1,/nan)</span>
<span class="code-output"> im2=image(stackmean,map_projection='orthographic',center_lat=90,grid_units=2,image_location=limit[[1,0]],image_dimensions=[limit[3]-limit[1],limit[2]-limit[0]],dimensions=[900,500],color='cyan',rgb_table=13)</span>
</code></div></div>      <img src="pp_drawsphericalpoly_ex9.png"/>
</p>

<p></p>

</div>
          

          
          <h3>Author information</h3>

            <dl class="attribute small" summary="Routine author information">
              
                <dt>Author:</dt>
                <dd><p>Paulo Penteado (http://www.ppenteado.net), Aug/2015
</p>

</dd>
              

              

              

              
            </dl>
          

          
          <h3>Other attributes</h3>

            <dl class="attribute small" summary="Other routine attributes">
              

              

              
                <dt>Requires:</dt>
                <dd><p>   If Coyote Graphics are to be used, the <a href="http://www.idlcoyote.com/documents/programs.php#COYOTE_LIBRARY_DOWNLOAD">Coyote Library</a>
   needs to be installed.
</p>

<p>   Also needed are <a href="./pp_sphericalpath.html#pp_sphericalpath"><code>pp_sphericalpath</code></a>, <a href="./pp_longtocolortriple.html#pp_longtocolortriple"><code>pp_longtocolortriple</code></a>, <a href="./pp_colortripletolong.html#pp_colortripletolong"><code>pp_colortripletolong</code></a>,
   and <a href="./tessellateshapes_pp.html#tessellateshapes_pp"><code>tessellateshapes_pp</code></a>, from <a href="http://www.ppenteado.net/idl/pp_lib.html">pp_lib</a>).
</p>

<p></p>

</dd>
              

              

              

              

              

              
            </dl>
          

          
          <h3>Statistics</h3>

            <table class="attribute small" summary="Routine statistics">
              <tr>
                <td class="name">Lines:</td>
                <td><div class="box orange"></div> 87 lines</td>
              </tr>

              <tr>
                <td class="name">Cyclomatic complexity:</td>
                <td><div class="box orange"></div> 19</td>
                <tr>
                  <td class="name">Modified cyclomatic complexity:</td>
                  <td><div class="box orange"></div> 15</td>
              </tr>
            </table>
          

        </div>
        

      </div>
      

      <div id="attributes">
        <h2>File attributes</h2>

        <table class="attribute small" summary="File attributes">
          <tr>
            <td class="name">Modification date:</td>
            <td>Tue May 16 12:27:40 2017</td>
          </tr>

          <tr>
            <td class="name">Lines:</td>
            <td>269</td>
          </tr>

          
          <tr>
            <td class="name">Docformat:</td>
            <td>rst rst</td>
          </tr>
          
        </table>
      </div>

      
    </div>

    <div class="footer">
    
      <table class="smaller" summary="footer">
        <tr>
          <td class="left">Produced by IDLdoc 3.6.1 on Tue May 16 12:42:24 2017</td>
          <td class="right"><a target="_top" href="http://github.com/mgalloy/idldoc">IDLdoc project information</a></td>
        </tr>
      </table>
    
    </div>
  </body>
</html>